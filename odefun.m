function dx=odefun(t1, x)
 %% 心血管系统参数
RM=0.005;
RA=0.001;
R=0;
Rs=1;
Rc=0.0398;
Cs=1.33;
CA=0.08;
CR=4.4;
Ls=0.0005;
%% 心脏建模
t=mod(t1,0.8);
Ct=1./(3.007.*(((t./0.224).^1.9)./(1+(t./0.224).^1.9)).*(1./(1+(t./0.3744).^21.9))+0.06);
dCt=((57133*((125*t)/28)^(14/5))/(2240*(((125*t)/28)^(19/10) + 1)^2*(((625*t)/234)^(219/10)...
    + 1)) - (57133*((125*t)/28)^(9/10))/(2240*(((125*t)/28)^(19/10) + 1)*(((625*t)/234)^(219/10) ...
    + 1)) + (219511*((125*t)/28)^(19/10)*((625*t)/234)^(209/10))/(1248*(((125*t)/28)^(19/10) ...
    + 1)*(((625*t)/234)^(219/10) + 1)^2))/((3007*((125*t)/28)^(19/10))/(1000*(((125*t)/28)^(19/10) ...
    + 1)*(((625*t)/234)^(219/10) + 1)) + 3/50)^2;
%% 系统微分方程
A=[(-dCt-R)/Ct,0,0,0,0;0,-1/(Rs*CR),1/(Rs*CR),0,0;0,1/(Rs*Cs),-1/(Rs*Cs),0,1/Cs;0,0,0,0,-1/CA;0,0,...
    -1/Ls,1/Ls,-Rc/Ls];
B=[1/Ct,-1/Ct; -1/CR,0;0,0;0,1/CA;0,0];
r=@(x)(x>=0).*x+(x<0).*0;
D=[1/RM*(r(x(2)-x(1)));1/RA*(r(x(1)-x(4)))];
dx=A*x+B*D;
end

